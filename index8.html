<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Add / Edit Product</title>
<link rel="stylesheet" href="style2.css">
<link href="https://fonts.googleapis.com/css2?family=Catamaran:wght@400;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Catamaran:wght@400;700&family=Paytone+One&display=swap" rel="stylesheet">
<style>
body { font-family:'Catamaran',sans-serif; margin:0; padding:0; }
.container { max-width:700px; margin:auto; padding:20px; }
.card { background:#fff; padding:20px; border-radius:12px; }
h1,h3 { text-align:center; }
.star-rating {
  display: flex;
  flex-direction: row-reverse; /* makes the first star left-most */
  justify-content: center;
  font-size: 1.6rem;
}

.star-rating input { display:none; }
.star-rating label { cursor:pointer; color:#ccc; padding:0 4px; }
.star-rating input:checked ~ label,
.star-rating label:hover,
.star-rating label:hover ~ label { color: gold; }
input,select { width:100%; padding:8px; margin-bottom:10px; }
button { margin-top:10px; padding:8px 14px; cursor:pointer; }
.button-wrapper { display:flex; justify-content:center; gap:8px; }
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <a href="index.html" class="home-icon" title="Go Home">
     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="home-svg">
     <path d="M3 9.5L12 3l9 6.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V9.5z" />
     </svg>
    </a>
    <h1 id="formTitle">Add New Product</h1>
    <form id="addProductForm">
      <input id="productName" placeholder="Product name" required>
      <input id="productBrand" placeholder="Brand" required>
      <input type="date" id="entryDate" required>
      <h3>Rate the product</h3>

      <label>Moisture</label>
      <div class="star-rating">
        <input type="radio" id="moisture5" name="moisture" value="5"><label for="moisture5">★</label>
        <input type="radio" id="moisture4" name="moisture" value="4"><label for="moisture4">★</label>
        <input type="radio" id="moisture3" name="moisture" value="3"><label for="moisture3">★</label>
        <input type="radio" id="moisture2" name="moisture" value="2"><label for="moisture2">★</label>
        <input type="radio" id="moisture1" name="moisture" value="1"><label for="moisture1">★</label>
      </div>

      <label>Definition</label>
      <div class="star-rating">
        <input type="radio" id="definition5" name="definition" value="5"><label for="definition5">★</label>
        <input type="radio" id="definition4" name="definition" value="4"><label for="definition4">★</label>
        <input type="radio" id="definition3" name="definition" value="3"><label for="definition3">★</label>
        <input type="radio" id="definition2" name="definition" value="2"><label for="definition2">★</label>
        <input type="radio" id="definition1" name="definition" value="1"><label for="definition1">★</label>
      </div>

      <label>No Buildup</label>
      <div class="star-rating">
        <input type="radio" id="buildup5" name="noBuildup" value="5"><label for="buildup5">★</label>
        <input type="radio" id="buildup4" name="noBuildup" value="4"><label for="buildup4">★</label>
        <input type="radio" id="buildup3" name="noBuildup" value="3"><label for="buildup3">★</label>
        <input type="radio" id="buildup2" name="noBuildup" value="2"><label for="buildup2">★</label>
        <input type="radio" id="buildup1" name="noBuildup" value="1"><label for="buildup1">★</label>
      </div>

      <label>Overall</label>
      <div class="star-rating">
        <input type="radio" id="overall5" name="overall" value="5"><label for="overall5">★</label>
        <input type="radio" id="overall4" name="overall" value="4"><label for="overall4">★</label>
        <input type="radio" id="overall3" name="overall" value="3"><label for="overall3">★</label>
        <input type="radio" id="overall2" name="overall" value="2"><label for="overall2">★</label>
        <input type="radio" id="overall1" name="overall" value="1"><label for="overall1">★</label>
      </div>

      <input id="notes" placeholder="Notes: e.g., style done, paired products, cost, other observations.
">
      <div class="button-wrapper">
        <button type="button" id="saveButton">Save Product</button>
        <a href="index7.html"><button type="button">Back</button></a>
      </div>
    </form>
  </div>
</div>

<script>
const urlParams = new URLSearchParams(window.location.search);
const editIndex = urlParams.get("edit"); // null if adding

function loadProducts(){ return JSON.parse(localStorage.getItem("products"))||[]; }
function saveProducts(products){ localStorage.setItem("products",JSON.stringify(products)); }

let products = loadProducts();
const numericEditIndex = editIndex !== null ? Number(editIndex) : null;

// Pre-fill if editing
if(numericEditIndex !== null){
  const p = products[numericEditIndex];
  document.getElementById("formTitle").innerText = "Edit Product";
  document.getElementById("productName").value = p.name;
  document.getElementById("productBrand").value = p.brand;
  document.getElementById("entryDate").value = p.date;
  document.getElementById("notes").value = p.optional.notes || "";

  ["moisture","definition","noBuildup","overall"].forEach(cat=>{
    const val = Number(p.ratings[cat]);
    if(val){
      const input = document.querySelector(`input[name="${cat}"][value="${val}"]`);
      if(input) input.checked = true;
    }
  });
}


function getStarValue(name){
  const checked = document.querySelector(`input[name="${name}"]:checked`);
  return checked ? Number(checked.value) : null;
}

document.getElementById("saveButton").addEventListener("click", ()=>{
  const productData = {
    name: document.getElementById("productName").value.trim(),
    brand: document.getElementById("productBrand").value.trim(),
    date: document.getElementById("entryDate").value,
    ratings: {
      moisture: getStarValue("moisture"),
      definition: getStarValue("definition"),
      noBuildup: getStarValue("noBuildup"),
      overall: getStarValue("overall")
    },
    optional: { notes: document.getElementById("notes").value }
  };

  if(Object.values(productData.ratings).includes(null)){
    alert("Please rate all categories.");
    return;
  }

  if(numericEditIndex !== null){
    // Update existing product in the array
    products[numericEditIndex] = productData;
  } else {
    // Add new product
    products.push(productData);
  }

  saveProducts(products); // save updated array to localStorage
  window.location.href = "index7.html"; // go back to main page

 
});


</script>
</body>
</html>
